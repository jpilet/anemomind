<div class="mapScreenContainer">

  <div class="mapAndGraphAndSidebar">
    <div ng-show="mapActive || graphActive" class="mapAndGraph">
      <div class="map" ng-show="mapActive">
        <div class="mainControl">
          <div class="section heading">
            <div class="boat-name">
              <span class="close-btn black" onclick="window.location='/'"></span>
              <label>{{boat.name}}</label>
            </div>
            <div class="share-boat">
              <div class="share-boat-holder">
                <i class="fa fa-share-alt share-lightbox" aria-hidden="true"></i> 
                <span class="share-popup share-lightbox">
                  Share
                </span>
              </div>
            </div>
          </div>
          <div class="section control-btns animationControls">
            <button type="button" class="btn btn-default btn-sm play" ng-hide="isPlaying" ng-click="togglePlayPause()">
              <i class="fa fa-play" aria-hidden="true"></i> 
              Play
            </button>
            <button type="button" class="btn btn-default btn-sm pause" ng-show="isPlaying" ng-click="togglePlayPause()">
              <i class="fa fa-pause" aria-hidden="true"></i> 
              pause
            </button>
            <div class="btn-grouped">
              <button type="button" class="btn btn-default btn-sm slower" ng-click="slower()">
                <i class="fa fa-minus" aria-hidden="true"></i>   
              </button>
              <span>{{ replaySpeed }}x</span>
              <button type="button" class="btn btn-default btn-sm faster" ng-click="faster()">
                <i class="fa fa-plus" aria-hidden="true"></i>  
              </button>
            </div>
            <button type="button" class="btn btn-default btn-sm cut-before" ng-click="cutBefore()">
              <i class="fa fa-scissors" aria-hidden="true"></i>
              <i class="fa fa-step-backward" aria-hidden="true"></i>
            </button>
            <button type="button" class="btn btn-default btn-sm cut-after" ng-click="cutAfter()">
              <i class="fa fa-step-forward" aria-hidden="true"></i>
              <i class="fa fa-scissors" aria-hidden="true"></i>
            </button>
            <button type="button" class="btn btn-default btn-sm split" ng-click="">
              Split
            </button>
            <div class="group-btn">
              <button type="button" class="btn btn-default btn-sm jump-prev" ng-click="">
                <i class="fa fa-undo" aria-hidden="true"></i>
              </button>
              <button type="button" class="btn btn-default btn-sm jump-next" ng-click="">
                <i class="fa fa-repeat" aria-hidden="true"></i>
              </button>
            </div>
          </div>
          <div class="info-group collapse-area">
            <div class="section tail-inputs">
              <div class="group perf-vmg">
                <i class="fa fa-anchor with-circle" aria-hidden="true"></i>
                <label>VMG</label>
                <input type="text" class="thin" name="perf-vmg">
              </div>
              <div class="group tail">
                <button class="btn btn-default btn-sm" ng-class="{'is-on' : toggleTail}" ng-click="toggleTail = !toggleTail;">
                  <i class="fa fa-tencent-weibo with-circle" aria-hidden="true"></i>
                  Tail
                </button>
              </div>
              <div class="group tail-length">
                <i class="fa fa-level-up" aria-hidden="true"></i>
                <label>Length</label>
                <input type="text" class="wide" name="tail-length" placeholder="sec" ng-model="tailLength">
              </div>
            </div>
            <div class="section perf-speed">
              <label class="expandable collapse-lbl" toggle-classes="collapse-area uncollapse-area">
                Performance & Speed 
                <i class="fa fa-plus" col-class="fa-plus" uncol-class="fa-minus" col-state="true" col-target=".collapsible" col-parent=".section" aria-hidden="true"></i>
              </label>
              <div class="collapsible group collapse-area moving-element" desktop-parent=".section.perf-speed" mobile-parent=".res-container.res-perf">
                <div class="perf">
                  <gauge-indicator id="gaugetws" label="vmgPerf + '%'" value="vmgPerf" description="'VMG Performance'" min="0" max="200" ></gauge-indicator>
                </div>
                <div class="speed">
                  <gauge-indicator
                  id="gaugeperf"
                  label="gpsSpeed | speed"
                  value="gpsSpeed"
                  description="'Speed over ground'" min="0" max="12" ></gauge-indicator>
                </div>
              </div>
            </div>
            <div class="section wind">
              <label class="expandable collapse-lbl" toggle-classes="collapse-area uncollapse-area">
                Wind 
                <i class="fa fa-plus" col-class="fa-plus" uncol-class="fa-minus" col-state="true" col-target=".collapsible" col-parent=".section" aria-hidden="true"></i>
              </label>
              <div class="collapsible group collapse-area moving-element" desktop-parent=".section.wind" mobile-parent=".res-container.res-wind">
                <div class="top-wheel">
                  <wheel-indicator id="topwheel" label="'Degree'" arrow="twa | angle:180" north="-gpsBearing" description="''"></wheel-indicator>
                </div>
                <div class="small-wheel">
                  <wheel-small-indicator id="smallwheelcog" label="'&deg;'" arrow="twdir | angle:360" boat="gpsBearing" north="0" description="'True Wind Direction'"></wheel-small-indicator>
                </div>
              </div>
            </div>
            <div class="section details">
              <label class="expandable collapse-lbl height-check" toggle-classes="collapse-area uncollapse-area">
                Details 
                <i class="fa fa-plus" col-class="fa-plus" uncol-class="fa-minus" col-state="true" col-target=".collapsible" col-parent=".section" aria-hidden="true"></i>
              </label>
              <div class="collapsible instrumentsView collapse-area moving-element" desktop-parent=".section.details" mobile-parent=".res-container.res-details">
                <div class="group">
                  <div data-ng-hide='vmgPerf == undefined'><label class="td-label">VMG Perf</label><span>{{ vmgPerf }}%</span></div>
                  <div data-ng-hide='deviceVmg == undefined'><label class="td-label">VMG</label><span>{{ deviceVmg | speed }}</span></div>
                  <div data-ng-hide='deviceTargetVmg == undefined'><label class="td-label">Target VMG</label><span>{{ deviceTargetVmg | speed }}</span></div>
                </div>
                <div class="group">
                  <div data-ng-hide='twa == undefined'><label class="td-label">TWA</label><span>{{ twa | angle:180 }}</span></div>
                  <div data-ng-hide='tws == undefined'><label class="td-label">TWS</label><span>{{ tws | speed }}</span></div>
                </div>
                <div class="group">
                  <div data-ng-hide='awa == undefined'><label class="td-label">AWA</label><span>{{ awa | angle:180 }}</span></div>
                  <div data-ng-hide='aws == undefined'><label class="td-label">AWS</label><span>{{ aws | speed }}</span></div>
                </div>
                <div class="group">
                  <div><label class="td-label">GPS speed</label><span>{{ gpsSpeed | speed }}</span></div>
                </div>
                <div class="group">
                  <div data-ng-hide='twdir == undefined'><label class="td-label">TWDIR</label><span>{{ twdir | angle:360 }}</span></div>
                  <div><label class="td-label">GPS bearing</label><span>{{ gpsBearing | angle:360 }}</span></div>
                  <div><label class="td-label">GPS pos.</label><span>{{ currentPoint.pos | geopos }}</span></div>
                </div>
                <div class="group">
                  <div><label class="td-label">Date</label><span>{{ currentTime | date: 'shortDate' }}</span></div>
                  <div><label class="td-label">Time</label><span>{{ currentTime | date: 'HH:mm:ss' }}</span></div>
                </div>
              </div>
            </div>
            <div class="expandable extension bottom-curve" toggle-classes="collapse-area uncollapse-area">
              <i class="fa fa-angle-double-down" col-class="fa-angle-double-down" uncol-class="fa-angle-double-up" col-state="true" col-target=".info-group" col-parent=".mainControl" aria-hidden="true"></i>
            </div>
          </div>
        </div>

        
        <div class="vectorMapContainer" vectormap></div>
      </div>

      <div class="graph unhide-area moving-element" desktop-parent=".mapAndGraph" mobile-parent=".res-container.res-graph" toggle-classes="hide-area unhide-area" ng-show="graphActive">
        <div class="expandable extension top-curve" toggle-classes="show hidden" mode="hide-parent">
          <i class="fa fa-angle-double-down" col-class="fa-angle-double-up" uncol-class="fa-angle-double-down" col-state="false" col-target=".graph-holder" col-parent=".graph" aria-hidden="true"></i>
        </div>
        <div class="graph-holder">
          <select id="dataSourceSelector"
          ng-model="plotField"
          ng-options="field as label for (field, label) in plotFieldLabels"></select>
          <perfplot
            plot-data="plotData"
            current-time="currentTime"
            field="plotField"></perfplot>
        </div>
      </div>
    </div>

    <sidebar class="sidebar-container unhide-area moving-element" desktop-parent=".mapAndGraphAndSidebar" mobile-parent=".res-container.res-photos" toggle-classes="hide-area unhide-area" ng-show="sideBarActive && eventList.length">
      <div class="expandable extension left-curve" toggle-classes="show hidden" mode="hide-parent">
        <i class="fa fa-angle-double-right" col-class="fa-angle-double-left" uncol-class="fa-angle-double-right" col-state="false" col-target=".semitransp" col-parent=".sidebar-container" aria-hidden="true"></i>
      </div>
      <div id="tabs" class="semitransp padding5px show">
        <div id="eventsContainer">
          <events boat="boat._id" before="endTime" after="startTime"
            current-time="currentTime" events="eventList">
          </events>
        </div>
      </div>
    </sidebar>
  </div>

  <footer class="responsiveNavButtons">
    <uib-tabset active="active">
      <uib-tab index="0" select="refreshGraph()">
        <uib-tab-heading>
          <i class="fa fa-area-chart"></i>
        </uib-tab-heading>
        <div class="res-container res-graph">
        </div>
      </uib-tab>
      <uib-tab index="1" select="refreshGraph()">
        <uib-tab-heading>
          <i class="fa fa-dashboard"></i>
        </uib-tab-heading>
        <div class="res-container res-perf">
        </div>
      </uib-tab>
      <uib-tab index="2" select="refreshGraph()">
        <uib-tab-heading>
          <i class="fa fa-flag"></i>
        </uib-tab-heading>
        <div class="res-container res-wind">
        </div>
      </uib-tab>
      <uib-tab index="3" select="refreshGraph()">
        <uib-tab-heading>
          <i class="fa fa-list"></i>
        </uib-tab-heading>
        <div class="res-container res-details">
        </div>
      </uib-tab>
      <uib-tab index="4" select="refreshGraph()" ng-show="eventList.length">
        <uib-tab-heading>
          <i class="fa fa-photo"></i>
        </uib-tab-heading>
        <div class="res-container res-photos">
          <hr/>
        </div>
      </uib-tab>
    </uib-tabset>
  </footer>
</div>
